{
  "version": 4,
  "terraform_version": "1.6.2",
  "serial": 12,
  "lineage": "d7e9d3d1-aaaa-bbbb-cccc-1234567890ab",
  "resources": [
    {
      "type": "aws_vpc",
      "name": "main",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "id": "vpc-111111",
            "cidr_block": "10.0.0.0/16",
            "enable_dns_support": true,
            "enable_dns_hostnames": true
          }
        }
      ]
    },

    {
      "type": "aws_lb",
      "name": "app",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:elasticloadbalancing:us-west-2:123456789012:loadbalancer/app/app-alb/aaa111",
            "name": "app-alb",
            "load_balancer_type": "application",
            "subnets": ["subnet-a", "subnet-b"]
          }
        }
      ]
    },

    {
      "type": "aws_lb_listener",
      "name": "http",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 1,
          "depends_on": ["aws_lb.app"],
          "attributes": {
            "load_balancer_arn": "arn:aws:elasticloadbalancing:us-west-2:123456789012:loadbalancer/app/app-alb/aaa111",
            "port": 80,
            "protocol": "HTTP"
          }
        }
      ]
    },

    {
      "type": "aws_lb_listener",
      "name": "https",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 1,
          "depends_on": ["aws_lb.app"],
          "attributes": {
            "load_balancer_arn": "arn:aws:elasticloadbalancing:us-west-2:123456789012:loadbalancer/app/app-alb/aaa111",
            "port": 443,
            "protocol": "HTTPS"
          }
        }
      ]
    },

    {
      "type": "aws_lb_target_group",
      "name": "api",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 1,
          "depends_on": ["aws_lb.app"],
          "attributes": {
            "arn": "arn:aws:elasticloadbalancing:us-west-2:123456789012:targetgroup/api/bbb111",
            "port": 8080,
            "protocol": "HTTP",
            "vpc_id": "vpc-111111"
          }
        }
      ]
    },

    {
      "type": "aws_lb_target_group",
      "name": "web",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 1,
          "depends_on": ["aws_lb.app"],
          "attributes": {
            "arn": "arn:aws:elasticloadbalancing:us-west-2:123456789012:targetgroup/web/ccc111",
            "port": 80,
            "protocol": "HTTP",
            "vpc_id": "vpc-111111"
          }
        }
      ]
    },

    {
      "type": "aws_eks_cluster",
      "name": "main",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 1,
          "depends_on": ["aws_vpc.main"],
          "attributes": {
            "name": "main-eks",
            "arn": "arn:aws:eks:us-west-2:123456789012:cluster/main-eks"
          }
        }
      ]
    },

    {
      "type": "aws_launch_template",
      "name": "workers_a",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "id": "lt-a",
            "instance_type": "t3.medium"
          }
        }
      ]
    },

    {
      "type": "aws_launch_template",
      "name": "workers_b",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "id": "lt-b",
            "instance_type": "t3.large"
          }
        }
      ]
    },

    {
      "type": "aws_autoscaling_group",
      "name": "workers_a",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 1,
          "depends_on": ["aws_launch_template.workers_a", "aws_eks_cluster.main"],
          "attributes": {
            "name": "asg-a",
            "desired_capacity": 2
          }
        }
      ]
    },

    {
      "type": "aws_autoscaling_group",
      "name": "workers_b",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 1,
          "depends_on": ["aws_launch_template.workers_b", "aws_eks_cluster.main"],
          "attributes": {
            "name": "asg-b",
            "desired_capacity": 3
          }
        }
      ]
    },

    {
      "type": "aws_s3_bucket",
      "name": "assets",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "bucket": "assets-bucket"
          }
        }
      ]
    },

    {
      "type": "aws_s3_bucket",
      "name": "logs",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "bucket": "logs-bucket"
          }
        }
      ]
    },

    {
      "type": "aws_db_instance",
      "name": "primary",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "id": "db-primary",
            "engine": "postgres"
          }
        }
      ]
    },

    {
      "type": "aws_db_instance",
      "name": "replica",
      "provider": "provider.aws",
      "instances": [
        {
          "schema_version": 1,
          "depends_on": ["aws_db_instance.primary"],
          "attributes": {
            "id": "db-replica",
            "engine": "postgres"
          }
        }
      ]
    }
  ]
}
